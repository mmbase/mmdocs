<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Summary of Coding Standards</title><link href="../style/documentation.css" rel="stylesheet" type="text/css" /><meta content="DocBook XSL Stylesheets V1.72.0" name="generator" /><link xmlns="" type="image/x-icon" href="../style/favicon.ico" rel="icon" /><link xmlns="" type="image/x-icon" href="../style/favicon.ico" rel="shortcut icon" /><meta xmlns="" content="text/html; charset=utf-8" http-equiv="content-type" /></head><body><div xmlns="" class="navigation"><img alt="mmbase logo" src="../style/logo.png" /><h2>Summary of Coding Standards</h2><p><a href="codingstandards.html#references">References</a></p><p><a href="codingstandards.html#introduction">Introduction</a></p><p><a href="codingstandards.html#documentation">Documentation</a></p><p><a href="codingstandards.html#naming">Naming</a></p><p><a href="codingstandards.html#spacing">Spacing</a></p><p><a href="codingstandards.html#other_style_conventions">Other style conventions</a></p><p><a href="codingstandards.html#mmbase_specific">Specific MMBase issues</a></p><p><a href="codingstandards.html#input_validation">Input validation</a></p><p><a href="codingstandards.html#strings">String operations</a></p><p><a href="codingstandards.html#portability">Portability</a></p><p><a href="codingstandards.html#ripples">Minimize ripple effects</a></p><p><a href="codingstandards.html#error_message">Error message conventions</a></p><p><a href="codingstandards.html#exceptions">Exception handling</a></p><p><a href="codingstandards.html#other_conventions">Other conventions</a></p><hr /><p><a href="http://www.mmbase.org">MMBase</a></p><p><a href="../index.html">home</a></p></div><div class="article" lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="N10001" />Summary of Coding Standards</h1></div><div><div class="authorgroup"><strong class="authorgroup">Authors: </strong><span class="author"><span class="firstname">Pierre</span> <span class="surname">van Rooden</span>, </span><span class="author"><span class="firstname">Nico</span> <span class="surname">Klasens</span></span><br /><strong class="authorgroup">Date: </strong>2003-02-14</div></div><div><div class="legalnotice"><a id="N10020" /><p>This software is OSI Certified Open Source Software. OSI Certified is a certification mark of the Open Source Initiative.</p><p>The license (Mozilla version 1.0) can be read at the MMBase site. See <a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.mmbase.org/license" target="_top">http://www.mmbase.org/license</a></p></div></div></div><hr /></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="codingstandards.html#references">1. References</a></span></dt><dt><span class="section"><a href="codingstandards.html#introduction">2. Introduction</a></span></dt><dt><span class="section"><a href="codingstandards.html#documentation">3. Documentation</a></span></dt><dt><span class="section"><a href="codingstandards.html#naming">4. Naming</a></span></dt><dt><span class="section"><a href="codingstandards.html#spacing">5. Spacing</a></span></dt><dt><span class="section"><a href="codingstandards.html#other_style_conventions">6. Other style conventions</a></span></dt><dt><span class="section"><a href="codingstandards.html#mmbase_specific">7. Specific MMBase issues</a></span></dt><dd><dl><dt><span class="section"><a href="codingstandards.html#logging">7.1. Logging</a></span></dt></dl></dd><dt><span class="section"><a href="codingstandards.html#input_validation">8. Input validation</a></span></dt><dt><span class="section"><a href="codingstandards.html#strings">9. String operations</a></span></dt><dt><span class="section"><a href="codingstandards.html#portability">10. Portability</a></span></dt><dt><span class="section"><a href="codingstandards.html#ripples">11. Minimize ripple effects</a></span></dt><dt><span class="section"><a href="codingstandards.html#error_message">12. Error message conventions</a></span></dt><dt><span class="section"><a href="codingstandards.html#exceptions">13. Exception handling</a></span></dt><dt><span class="section"><a href="codingstandards.html#other_conventions">14. Other conventions</a></span></dt></dl></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="references" />1. References</h2></div></div></div><p>The following is a summary of coding standards that need to be applied to source code.</p><p>All future sources need to conform to these standards.</p><p>The style conventions were based on suggestions from the following documents:</p><div class="itemizedlist"><ul type="disc"><li><p><a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://java.sun.com/docs/codeconv/" target="_top">Code Conventions for the JavaTM Programming Language</a></p><p>This is the basis for these guidelines. Unless otherwise specified, the conventions described here follow those as outlined in the
        above document.</p></li><li><p><a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.ambysoft.com/javaCodingStandards.html" target="_top">AmbySoft Inc. Coding Standards for Java</a></p><p>This document contains several suggestions which were used to expand the standard conventions, especially for naming
        identifiers.</p></li><li><p><a xmlns:xlink="http://www.w3.org/1999/xlink" href="http://www.objectmentor.com/publications/naming.htm" target="_top">Ottinger's Rules for Variable and Class Naming</a></p><p>This document also contains suggestions for naming, focused on improving the readability of your code.</p></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="introduction" />2. Introduction</h2></div></div></div><p>We understand that formatting is a matter of taste and that many developers prefer other formmatting styles, but try to stick to the
    guidelines. We are using them to keep the code readable. Don't take it personally when someone points you to the coding standards when you submit
    some code. We will accept your code anyway.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="documentation" />3. Documentation</h2></div></div></div><p>Every method, whether public or private, must start out with a documentation comment that describes what the method does. The documentation
    should mention every parameter received by the method, every possible return value, and (if not obvious) the conditions under which the method
    could return an error. Put the parameter names in the same case in the doc string as in the method signature,</p><p>Read over the MMBase code to get an overview of how documentation looks in practice; in particular, see src/org/mmbase/bridge/* for
    examples.</p><div class="itemizedlist"><ul type="disc"><li>Java documentation is mandatory!</li><li>Use C-style documentation (/*...*/) for documenting-out obsolete code</li><li><p>Use Single line documentation (// ...) for in-code documentation.</p><p>Single line comments should be on their own line, preceding the statement concerned. The exception is local variables declaration,
        where the line comment may follow directly behind the declaration.</p></li><li><p>Required javadoc tags:</p><div class="itemizedlist"><ul type="circle"><li><p>For a class/interface:</p><p><span class="token">@author</span> (by alphabetical order)</p><p><span class="token">@version</span> (versions should be annotated with <span class="token">@version</span> $Id: codingstandards.xml,v 1.6 2004/02/17
            10:21:13 gerard Exp $ , so that CVS can insert the correct version number.)</p></li><li><p>For a member function:</p><p><span class="token">@param</span></p><p><span class="token">@return</span></p><p><span class="token">@exception</span></p></li><li><p>From version 1.5 of MMBase and onwards, new classes and member functions should contain the <span class="token">@since</span>tag (i.e.
            <span class="token">@since</span> MMBase-1.6)</p><p>The version to use during development will be defined by the MMC.</p></li><li>Deprecated member functions should be indicated as such with <span class="token">@deprecated</span>, and the reason should be given</li><li>Important member function or class dependencies should be documented with <span class="token">@see</span></li><li>Special targeted javadoc tags are documented in the Cleaning Project Notification Plan (see the Cleaning project on the MMBase
            website for more information)</li></ul></div></li><li><p>Use Single line documentation (<span class="token">// ...</span>) for in-code documentation.</p><p>Single line comments should be on their own line, preceding the statement concerned. The exception is local variables declaration,
        where the line comment may follow directly behind the declaration.</p></li></ul></div><p>If you are one of those developers who has a personal issue with documentation then at least document the public methods of your code.
    Public methods can be used by everyone and should have a clear contract. One exception to this rule are getter and setter methods.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="naming" />4. Naming</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>Names should be full English descriptors where possible. They should be smaller than 20 characters and unique within the
        context.</p><div class="itemizedlist"><ul type="circle"><li><p>Interface names may be :</p><div class="itemizedlist"><ul type="square"><li>adjectives, i.e <span class="token">Runnable</span>. These names should apply to interfaces that describe one specific property or
                behavior that applies to different classes but is not the 'main' task of these classes</li><li>&lt;basename&gt;Interface, i.e. <span class="token">TransactionManagerInterface</span>. These names should describe complex behavior
                which is the main task of an implementing class.</li><li>Nouns, i.e. <span class="token">Node</span>. Only a specific set of interfaces (such as the bridge and security) use nouns.</li></ul></div></li><li>The first word in a member function name should be an active verb</li><li>Member field names should not start with verbs. They may start with m_ to emphasize them as being member fields in the
            code.</li><li>Collections (lists, enumerations) should be given a plural name</li><li>Names of member functions that retrieve a field should start with <span class="token">get</span>. Member functions that retrieve a boolean
            field should start with <span class="token">is</span>, or optionally <span class="token">has</span>, or <span class="token">can</span>, depending on the data
            retrieved.</li><li>Names of member functions that set a field should start with <span class="token">set</span>.</li><li>Parameters and local variables for streams can be named <span class="token">in</span>, <span class="token">out</span>, or <span class="token">inOut</span>.</li><li>Local variables for loop counters may use short generic names. Accepted names are <span class="token">i</span>, <span class="token">j</span>, or
            <span class="token">k</span>. Note: Collections should use Iterator (preferred) or Enumeration for loops, not counters</li><li>Parameters and local variables for exceptions can be named <span class="token">e</span>.</li><li>Package names should be singular.</li></ul></div></li><li>Specific choices for names by category:</li><li><p>Case:</p><div class="itemizedlist"><ul type="circle"><li>Except for constants, Names should use mixed case: capitalize first letters of class, interface, and constructor names (other
            member functions or fields use lowercase), and capitalize the first letter of every non-initial word.</li><li>Constants are all upper case and should be defined as static final.</li><li>Do not fully capitalize acronym such as <span class="token">SQL</span> or <span class="token">XML</span> (but <span class="token">sql/Sql</span> or
            <span class="token">xml/Xml</span>)</li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="spacing" />5. Spacing</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>Indentation is four spaces for each block. Do not use tabs.</p><p>This deviates from some standards, there are differences in how people use tabs or how editors show them. The alternate would be to
        use ONLY tabs (which is not likely to work).</p></li><li>A keyword followed by a parenthesis should be separated by a space (i.e. if (...))</li><li>A method and it's parameter list should NOT be separated by a space.</li><li>A space should be inserted after a comma in a list, or a semicolon in a for-statement.</li><li>All binary operators should be separated by spaces.</li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="other_style_conventions" />6. Other style conventions</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li>At most one declaration per line.</li><li>Declarations should be at the beginning of a block.</li><li>At most one statement per line.</li><li><p>Placing of braces for blocks follow the C-standard :</p><pre class="programlisting">
    statement {
        otherstatement;
    }
          </pre></li><li><span class="token">if</span>, <span class="token">for</span>, <span class="token">do</span>, <span class="token">while</span>, <span class="token">switch</span> and <span class="token">try/catch</span>
        blocks should be braced.</li><li>Values of return statements should not be put in parenthesis - <span class="token">return</span> is a statement, not a function.</li><li>Restrict access to member functions as much as possible. All fields should be private, unless they are constants. Accessing a field
        should work using the accessor member functions.</li><li><p>Elements in a class should be ordered in the following way:</p><div class="orderedlist"><ol type="1"><li>public static fields (constants)</li><li>private static fields (i.e. log field)</li><li>private fields</li><li>constructors</li><li>finalize()</li><li>static public member functions</li><li>static protected member functions</li><li>static private member functions</li><li>public member functions</li><li>protected member functions</li><li>private member functions</li><li>public static void main()</li></ol></div></li><li>Use named constants, not literals.</li><li>Use wildcards in import statements if you use 3 or more classes from the same package.</li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="mmbase_specific" />7. Specific MMBase issues</h2></div></div></div><div class="itemizedlist"><ul type="disc"><li>Each class should contain the Mozilla license text.</li><li>New java objects are made using member functions that start with <span class="token">create</span>, i,e <code class="methodname">createAlias()</code>,
        <code class="methodname">createObject()</code>. The prefixes <span class="token">add</span> and <span class="token">insert</span> are only used for Collections.</li><li>Remove java objects with member functions starting with <span class="token">delete</span> (i.e. <code class="methodname">deleteAlias</code>,
        <code class="methodname">deleteRelations</code>).</li></ul></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="logging" />7.1. Logging</h3></div></div></div><p>
        MMBase has it's own logging facility (similar, but older than commons logging).
      </p><p>
        Every class has its own logger, identified with the name of the class. The logger instance
        is final static private. It is not necessary that the logger instance is used, and therefore
        this is perhaps the only variable which need not be removed if it is not used.
      </p><p>
        MMBase has the following logging levels, from low to high.
      </p><div class="itemizedlist"><ul type="disc"><li><p><b>trace. </b>
              log.trace can be used for things which happen very often, and can be used during
              debugging. log.trace should be protected by log.isDebugEnabled, especially if the
              argument is costly (complicated toStrings, may concatations). In inner-loops log.trace
              should perhaps not be used at all (or commented out).
            </p></li><li><p><b>debug. </b>
              log.debug can be used for things which happen not very often, but still are only
              interesing during debugging. log.debug should be protected by log.isDebugEnabled,
              especially if the argument is costly (complicated toStrings, may concatations). In
              inner-loops log.debug should not be used at all (or commented out).
            </p></li><li><p><b>service. </b>
              log.service is to be used for events which can interest the interested
              administrator. It is used for things which happen only seldomly, and which may be
              heavy on resources (like for example sending mail or converting an image). It can also
              be used for one-time messages during start-up and shutdown.
            </p></li><li><p><b>info. </b>
              log.info is even higher then 'service'. Even uninterested adminstrators need to know
              this, or probably want to know this. Very important things during startup and
              shut-down or otherwise one-time only events can also be logged on info.
            </p></li><li><p><b>warn. </b>
              If something's wrong, but there exist a reasonable fall-back, the event can be logged as a warning.
            </p></li><li><p><b>error. </b>
              If something's wrong, and no reasonable fall-back exists, the event can be logged as an error.
            </p></li><li><p><b>fatal. </b>
              Something is so wrong, that MMBase will not work any more. This can be logged as fatal
              error. E.g. no database-connection could be acquired.
            </p></li></ul></div><p>
        When using the value of a variable in the log message and there exists even the tiniest
        chance that this variable's toString evaluates to the empty String, single quotes must
        surround the value. Make absolutely sure that not accidently an Exception (especially
        NullPointerException) can be caused during the creation of the message.
      </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="input_validation" />8. Input validation</h2></div></div></div><p>The first lines of a method are usually devoted to checking the validity of all arguments. The idea is to fail as quickly as possible in the
    event of an error. This is particularly important for constructors.</p><p>For non-private methods, an Exception is thrown if a test on an argument fails. This is often IllegalArgumentException or
    NullPointerException. (These are RuntimeExceptions. Checked exceptions may also be thrown Document these exceptions in the @throws clause of the
    method's javadoc, since they clearly state the method's requirements to the caller (the pre-conditions).</p><p>If every object parameter of every method in a class needs to be non-null in order to avoid throwing NullPointerException, then it is
    acceptable to state this once in the general class javadoc, instead of repeating it for each method.</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="strings" />9. String operations</h2></div></div></div><p>To build Strings dynamically, one may use either the String concatenation operator + or the StringBuffer class. In the great majority of
    cases, only a few items are concatenated, and either style may be used freely, according to taste, without concern for performance.</p><p>On relatively rare occasions, however, when performing extensive String manipulation, replacing + with StringBuffer.append is recommended.
    This is because the + operator does not scale well to large numbers of operations, and is much slower than StringBuffer.append under such
    circumstances.</p><p>Cases in which + is very likely acceptable :</p><div class="itemizedlist"><ul type="disc"><li>if concatenating only a small number of items together, then the difference in relative performance is very small, and possibly not
        even measurable (the great majority of use cases of the concatenation operator fall into this category).</li><li>in branches of code which represent a failure in the system - for example, a lost database connection, or an invalid method
        parameter. Since these branches are very rarely exercised, the speed at which the system fails is usually not important</li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="portability" />10. Portability</h2></div></div></div><p>Portability is one of the principal advantages of using Java. Guidelines for ensuring that a Java application remains portable are:</p><div class="itemizedlist"><ul type="disc"><li>do not use hard coded file names and paths - use the File class, and allow file paths to be configured during deployment.</li><li>remember that some systems have case sensitive file names (Unix), while others do not (Windows).</li><li>do not use hard coded constants. Use the System.getProperty method to refer to items which depend on the system, such as line
        terminators and path separators.</li><li>be very wary of Runtime.exec and Method.invoke</li><li>do not rely on thread scheduling to define program logic</li><li>do not use native methods</li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ripples" />11. Minimize ripple effects</h2></div></div></div><p>Much of object programming is centered on minimizing the ripple effects caused by changes to a program. This is done simply by keeping
    details secret (information hiding or encapsulation).</p><p>The principal ways of doing this are</p><div class="itemizedlist"><ul type="disc"><li>indirection - named constants replacing "magic numbers", for example</li><li>minimizing visibility - private fields, package-private classes, for example</li><li>generic references (polymorphism) - using high level references (interfaces or abstract classes) instead of low level references
        (concrete classes)</li></ul></div><p>All of these techniques accomplish the same thing - they confine knowledge of implementation details to the smallest possible part of a
    program. That is, they keep a secret of some sort.</p><p>Constant and liberal use of the above techniques is recommended. For example:</p><div class="itemizedlist"><ul type="disc"><li>fields are almost always private</li><li>Collections, IO streams usually allow use of interface references</li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="error_message" />12. Error message conventions</h2></div></div></div><p>For error messages the following conventions apply:</p><div class="itemizedlist"><ul type="disc"><li>Provide specific error messages with all the relevant information (variables, exceptions, etc.)</li><li>Messages start with a capital letter.</li><li>Try keeping messages below 70 characters.</li><li>Don't end the error message with a '.'.</li><li>Don't use wildcard characters (* ? \) inside the error string. A search in the logs for text containing these characters are always
        difficult.</li><li>Don't include newline characters in error messages.</li><li>Quoting information is done using single quotes ('some info').</li><li>Don't include the name of the method where the error occurs in the error message. Log systems will provide this information by
        itself.</li><li>When including path or filenames in the error string, be sure to quote them. (i.e. "Can't find '/path/to/repos/userfile'")</li><li>Suggestions or other additions can be added after a semi-colon, like this: "Can't write to 'file': object of same name already
        exists; remove before retrying"</li><li>Try to stay within the boundaries of these conventions, so please avoid separating different parts of error messages by other
        separators such as '--' and others.</li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="exceptions" />13. Exception handling</h2></div></div></div><p>Exceptions in java are used to communicate errors between a callee and a caller. They aren't supposed to be used for control flow (throw and
    catch in the same method). Exception declarations are usually found on the boundaries of an API.</p><p>A section on writing error messages can be found elsewhere in this document under the title 'Error message conventions'.</p><p>Here are some of the guidelines for exception handling in MMBase.</p><div class="itemizedlist"><ul type="disc"><li>In the throws clause of a method header, be as specific as possible. Do not group together related exceptions in a generic exception
        class that would represent a loss of possibly important information.</li><li>Do not catch or throw Throwable, Error, RuntimeException or Exception. Narrow types are more informational. Use for example:
        IllegalArgumentException or UnsupportedOperation</li><li><p>Never throw the error upwards, unmodified:</p><pre class="programlisting">
            try {
                ......
            } catch(Exception e) {
                throw e;
            }
          </pre><p>This code only pollutes the code base and adds nothing.</p></li><li><p>If you *receive* an error, you have two choices:</p><div class="itemizedlist"><ul type="circle"><li>Handle the error yourself. Use either your own code, or just log the error. Never leave a catch clause empty, log the error on
            debug or trace.</li><li>Throw the error upwards, wrapping it in a new exception and including the error as a "child" argument:</li></ul></div></li></ul></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="other_conventions" />14. Other conventions</h2></div></div></div><p>There are many other unspoken conventions maintained throughout the code, that are only noticed when someone unintentionally fails to follow
    them. Just try to have a sensitive eye for the way things are done, and when in doubt, ask.</p></div></div><hr xmlns="" /><p xmlns="">
      This is part of the <a href="http://www.mmbase.org">MMBase</a> documentation.
    </p><p xmlns="">
      For questions and remarks about this documentation mail to: 
      <a href="/cdn-cgi/l/email-protection#14707b776179717a6075607d7b7a547979767567713a7b6673"><span class="__cf_email__" data-cfemail="d0b4bfb3a5bdb5bea4b1a4b9bfbe90bdbdb2b1a3b5febfa2b7">[email&#160;protected]</span></a></p><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body></html>